# PostgreSQL Client Authentication Configuration File
# ===============================================
#
# Refer to the PostgreSQL documentation for details on the format of this file.
# https://www.postgresql.org/docs/current/auth-pg-hba-conf.html

# Allow replication connections from localhost, by a user with the
# replication privilege.

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     trust

# IPv4 local connections:
host    all             all             127.0.0.1/32            scram-sha-256

# IPv6 local connections:
host    all             all             ::1/128                 scram-sha-256

# Allow replication connections from localhost, by a user with the
# replication privilege.
local   replication     all                                     trust
host    replication     all             127.0.0.1/32            scram-sha-256
host    replication     all             ::1/128                 scram-sha-256

# SSL connections
hostssl all             all             all                     scram-sha-256    clientcert=verify-ca

# Allow all connections without SSL (for internal connections)
host    all             all             all                     trust

# Deny all other connection attempts
deny    all             all             all                     reject

# Log all connection attempts
# This is useful for debugging but can generate a lot of logs in production
# log_connections = on
# log_disconnections = on
# log_hostname = on
# log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,client=%h,app=%a '
